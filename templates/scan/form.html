{% extends "scan/base.html" %}
{% block js %}
{{ form.media }}
<script type="text/javascript" src="{{ STATIC_URL }}js/chk_inn.js"></script>
<script type="text/javascript">
	function enable_suppX (v) {
		// switch supplier names enable/disable
		$('#id_suppname').prop( "disabled", !v );
		$('#id_suppfull').prop( "disabled", !v );
	};
	function inn_focus() {
		console.log('focus');
		enable_suppX(true);
	};
	function inn_blur() {
		console.log('blur');
		v = $('#id_suppinn').val()
		//console.log('INN: ' + v);
		result = checkINN(v);
		if (result == null) {
			console.log("ИНН OK");
			// find inn in db
			// if found: fill supp*; disable them; focus to id_billno
		} else {
			console.log("ERR: " + result);
			enable_suppX(false);
		};
	};
	$(document).ready(function() {
		$('#id_suppinn').focus(function() {inn_focus();});
		$('#id_suppinn').blur(function() {inn_blur();});
	});
</script>
{% endblock %}
{% block body_main %}
   <form enctype="multipart/form-data" action="" method="POST">
	{% csrf_token %}
	<table border="1">
		{{ form.as_table }}
 <tr>
  <td> Оригинал: </td>
  <td> <ol style="margin: 0">
   {% for img in object.fileseq.fileseqitem_set.all %}
    <li>
     <a href="{% url 'core.views.file_get' img.pk %}" data-lightbox="roadtrip"> <img src="{{ STATIC_URL }}img/32/png.png" title="{{ img.file.name }}"/> </a>
     <a href="{% url 'core.views.file_get' img.pk %}"> <img src="{{ STATIC_URL }}img/32/download.png" title="Скачать"/> </a>
    </li>
   {% endfor %}
  </ol> </td>
 </tr>
	</table>
	<button type="submit"> Записать </button>
	<a href="{% url 'scan_view' object.pk %}"> <button type="button"> Отказаться </button> </a>
   </form>
{% endblock %}
